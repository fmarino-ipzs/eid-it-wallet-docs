<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="1636px" preserveAspectRatio="none" style="width:1410px;height:1636px;background:#FFFFFF;" version="1.1" viewBox="0 0 1410 1636" width="1410px" zoomAndPan="magnify"><defs/><g><rect fill="#ADD8E6" height="1624.7734" style="stroke:#181818;stroke-width:0.5;" width="467.4092" x="194.3389" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="106.5645" x="374.7612" y="18.0669">User's Devices</text><rect fill="#ADD8E6" height="1624.7734" style="stroke:#181818;stroke-width:0.5;" width="458.2202" x="943.9946" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="98.6997" x="1123.7549" y="18.0669">Relying Party</text><g><title>User</title><rect fill="#FFFFFF" height="51.1328" style="stroke:#181818;stroke-width:1;" width="10" x="18.9551" y="91.2969"/></g><g><title>User</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1;" width="10" x="18.9551" y="935.4219"/></g><g><title>Wallet Instance</title><rect fill="#FFFFFF" height="958.0547" style="stroke:#181818;stroke-width:1;" width="10" x="254.4897" y="444.7578"/></g><g><title>user-agent</title><rect fill="#FFFFFF" height="332.3281" style="stroke:#181818;stroke-width:1;" width="10" x="607.7334" y="112.4297"/></g><g><title>user-agent</title><rect fill="#FFFFFF" height="44.2656" style="stroke:#181818;stroke-width:1;" width="10" x="607.7334" y="1447.0781"/></g><g><title>Relying Party</title><rect fill="#FFFFFF" height="244.0625" style="stroke:#181818;stroke-width:1;" width="10" x="999.8628" y="171.5625"/></g><g><title>Relying Party</title><rect fill="#FFFFFF" height="122.2031" style="stroke:#181818;stroke-width:1;" width="10" x="999.8628" y="657.6875"/></g><g><title>Relying Party</title><rect fill="#FFFFFF" height="393.9922" style="stroke:#181818;stroke-width:1;" width="10" x="999.8628" y="1008.8203"/></g><g><title>status endpoint</title><rect fill="#FFFFFF" height="44.2656" style="stroke:#181818;stroke-width:1;" width="10" x="1331.4419" y="1447.0781"/></g><rect fill="#FFFFFF" fill-opacity="0.00000" height="59.2656" style="stroke:#000000;stroke-width:1.5;" width="210.6118" x="188.3389" y="459.7578"/><rect fill="#FFFFFF" fill-opacity="0.00000" height="132.3359" style="stroke:#000000;stroke-width:1.5;" width="1133.1226" x="188.3389" y="619.4219"/><g><title>User</title><rect fill="#FFFFFF" fill-opacity="0.00000" height="1470.1797" width="8" x="19.9551" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="23" x2="23" y1="81.2969" y2="1551.4766"/></g><g><title>Wallet Instance</title><rect fill="#FFFFFF" fill-opacity="0.00000" height="1470.1797" width="8" x="255.4897" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="259.3389" x2="259.3389" y1="81.2969" y2="1551.4766"/></g><g><title>user-agent</title><rect fill="#FFFFFF" fill-opacity="0.00000" height="1470.1797" width="8" x="608.7334" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="612.7188" x2="612.7188" y1="81.2969" y2="1551.4766"/></g><g><title>Relying Party</title><rect fill="#FFFFFF" fill-opacity="0.00000" height="1470.1797" width="8" x="1000.8628" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1003.9946" x2="1003.9946" y1="81.2969" y2="1551.4766"/></g><g><title>status endpoint</title><rect fill="#FFFFFF" fill-opacity="0.00000" height="1470.1797" width="8" x="1332.4419" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1335.6689" x2="1335.6689" y1="81.2969" y2="1551.4766"/></g><g><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31.9102" x="5" y="77.9951">User</text><ellipse cx="23.9551" cy="13.5" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M23.9551,21.5 L23.9551,48.5 M10.9551,29.5 L36.9551,29.5 M23.9551,48.5 L10.9551,63.5 M23.9551,48.5 L36.9551,63.5 " fill="#FFFFFF" fill-opacity="0.00000" style="stroke:#181818;stroke-width:0.5;"/></g><g><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31.9102" x="5" y="1563.4717">User</text><ellipse cx="23.9551" cy="1575.2734" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M23.9551,1583.2734 L23.9551,1610.2734 M10.9551,1591.2734 L36.9551,1591.2734 M23.9551,1610.2734 L10.9551,1625.2734 M23.9551,1610.2734 L36.9551,1625.2734 " fill="#FFFFFF" fill-opacity="0.00000" style="stroke:#181818;stroke-width:0.5;"/></g><g><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="122.3018" x="198.3389" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108.3018" x="205.3389" y="69.9951">Wallet Instance</text></g><g><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="122.3018" x="198.3389" y="1550.4766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108.3018" x="205.3389" y="1570.4717">Wallet Instance</text></g><g><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="90.0293" x="567.7188" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76.0293" x="574.7188" y="69.9951">user-agent</text></g><g><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="90.0293" x="567.7188" y="1550.4766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76.0293" x="574.7188" y="1570.4717">user-agent</text></g><g><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="113.7363" x="947.9946" y="33.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93.167" x="958.2793" y="53.6982">Relying Party</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99.7363" x="954.9946" y="69.9951">(OAuth Client)</text></g><g><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="113.7363" x="947.9946" y="1550.4766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93.167" x="958.2793" y="1570.4717">Relying Party</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99.7363" x="954.9946" y="1586.7686">(OAuth Client)</text></g><g><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="123.5459" x="1274.6689" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109.5459" x="1281.6689" y="69.9951">status endpoint</text></g><g><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="123.5459" x="1274.6689" y="1550.4766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109.5459" x="1281.6689" y="1570.4717">status endpoint</text></g><g><title>User</title><rect fill="#FFFFFF" height="51.1328" style="stroke:#181818;stroke-width:1;" width="10" x="18.9551" y="91.2969"/></g><g><title>User</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1;" width="10" x="18.9551" y="935.4219"/></g><g><title>Wallet Instance</title><rect fill="#FFFFFF" height="958.0547" style="stroke:#181818;stroke-width:1;" width="10" x="254.4897" y="444.7578"/></g><g><title>user-agent</title><rect fill="#FFFFFF" height="332.3281" style="stroke:#181818;stroke-width:1;" width="10" x="607.7334" y="112.4297"/></g><g><title>user-agent</title><rect fill="#FFFFFF" height="44.2656" style="stroke:#181818;stroke-width:1;" width="10" x="607.7334" y="1447.0781"/></g><g><title>Relying Party</title><rect fill="#FFFFFF" height="244.0625" style="stroke:#181818;stroke-width:1;" width="10" x="999.8628" y="171.5625"/></g><g><title>Relying Party</title><rect fill="#FFFFFF" height="122.2031" style="stroke:#181818;stroke-width:1;" width="10" x="999.8628" y="657.6875"/></g><g><title>Relying Party</title><rect fill="#FFFFFF" height="393.9922" style="stroke:#181818;stroke-width:1;" width="10" x="999.8628" y="1008.8203"/></g><g><title>status endpoint</title><rect fill="#FFFFFF" height="44.2656" style="stroke:#181818;stroke-width:1;" width="10" x="1331.4419" y="1447.0781"/></g><g><polygon fill="#181818" points="595.7334,108.4297,605.7334,112.4297,595.7334,116.4297,599.7334,112.4297" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="28.9551" x2="601.7334" y1="112.4297" y2="112.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="35.9551" y="107.3638">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154.0449" x="49.0005" y="107.3638">Web Service navigation</text></g><g><polygon fill="#181818" points="987.8628,167.5625,997.8628,171.5625,987.8628,175.5625,991.8628,171.5625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="617.7334" x2="993.8628" y1="171.5625" y2="171.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="624.7334" y="166.4966">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184.8691" x="637.7788" y="166.4966">Request Protected Resource</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1403.2148" x="0" y="200.1289"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1403.2148" y1="200.1289" y2="200.1289"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1403.2148" y1="203.1289" y2="203.1289"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="161.5703" x="620.8223" y="189.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="143.0444" x="626.8223" y="205.6294">Presentation Phase</text><g><line style="stroke:#181818;stroke-width:1;" x1="1009.8628" x2="1051.8628" y1="258.9609" y2="258.9609"/><line style="stroke:#181818;stroke-width:1;" x1="1051.8628" x2="1051.8628" y1="258.9609" y2="271.9609"/><line style="stroke:#181818;stroke-width:1;" x1="1010.8628" x2="1051.8628" y1="271.9609" y2="271.9609"/><polygon fill="#181818" points="1020.8628,267.9609,1010.8628,271.9609,1020.8628,275.9609,1016.8628,271.9609" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="1016.8628" y="246.3286">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.2852" x="1029.9082" y="238.7622">Create a state value</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179.1753" x="1029.9082" y="253.895">bound to user-agent cookie</text></g><g><line style="stroke:#181818;stroke-width:1;" x1="1009.8628" x2="1051.8628" y1="301.0938" y2="301.0938"/><line style="stroke:#181818;stroke-width:1;" x1="1051.8628" x2="1051.8628" y1="301.0938" y2="314.0938"/><line style="stroke:#181818;stroke-width:1;" x1="1010.8628" x2="1051.8628" y1="314.0938" y2="314.0938"/><polygon fill="#181818" points="1020.8628,310.0938,1010.8628,314.0938,1020.8628,318.0938,1016.8628,314.0938" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="1016.8628" y="296.0278">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181.9429" x="1029.9082" y="296.0278">Create request_uri resource</text></g><g><line style="stroke:#181818;stroke-width:1;" x1="1009.8628" x2="1051.8628" y1="358.3594" y2="358.3594"/><line style="stroke:#181818;stroke-width:1;" x1="1051.8628" x2="1051.8628" y1="358.3594" y2="371.3594"/><line style="stroke:#181818;stroke-width:1;" x1="1010.8628" x2="1051.8628" y1="371.3594" y2="371.3594"/><polygon fill="#181818" points="1020.8628,367.3594,1010.8628,371.3594,1020.8628,375.3594,1016.8628,371.3594" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="1016.8628" y="345.7271">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155.2446" x="1029.9082" y="338.1606">Inspect user-agent type</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="247.5269" x="1029.9082" y="353.2935">to detect cross device or same device</text></g><g><polygon fill="#181818" points="628.7334,411.625,618.7334,415.625,628.7334,419.625,624.7334,415.625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="622.7334" x2="1003.8628" y1="415.625" y2="415.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="634.7334" y="402.9927">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="345.084" x="647.7788" y="395.4263">html page with QRCode or href containig the url with</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="325.438" x="647.7788" y="410.5591">client_id, request_uri, state, [request_uri_method]</text></g><g><polygon fill="#181818" points="34.9551,440.7578,24.9551,444.7578,34.9551,448.7578,30.9551,444.7578" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="28.9551" x2="611.7334" y1="444.7578" y2="444.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="40.9551" y="439.6919">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="307.2012" x="54.0005" y="439.6919">Show the QRCode page or click the href button</text></g><path d="M188.3389,459.7578 L362.9263,459.7578 L362.9263,466.8906 L352.9263,476.8906 L188.3389,476.8906 L188.3389,459.7578 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="#FFFFFF" fill-opacity="0.00000" height="59.2656" style="stroke:#000000;stroke-width:1.5;" width="210.6118" x="188.3389" y="459.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="129.5874" x="203.3389" y="472.8247">Cross Device only</text><g><line style="stroke:#181818;stroke-width:1;" x1="264.4897" x2="306.4897" y1="498.0234" y2="498.0234"/><line style="stroke:#181818;stroke-width:1;" x1="306.4897" x2="306.4897" y1="498.0234" y2="511.0234"/><line style="stroke:#181818;stroke-width:1;" x1="265.4897" x2="306.4897" y1="511.0234" y2="511.0234"/><polygon fill="#181818" points="275.4897,507.0234,265.4897,511.0234,275.4897,515.0234,271.4897,511.0234" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="271.4897" y="492.9575">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92.4155" x="284.5352" y="492.9575">Scan QR Code</text></g><g><polygon fill="#181818" points="242.4897,558.2891,252.4897,562.2891,242.4897,566.2891,246.4897,562.2891" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="23.9551" x2="248.4897" y1="562.2891" y2="562.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="30.9551" y="549.6567">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193.4893" x="44.0005" y="542.0903">Open the Wallet Instance app</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161.4146" x="44.0005" y="557.2231">local user authentication</text></g><g><line style="stroke:#181818;stroke-width:1;" x1="264.4897" x2="306.4897" y1="591.4219" y2="591.4219"/><line style="stroke:#181818;stroke-width:1;" x1="306.4897" x2="306.4897" y1="591.4219" y2="604.4219"/><line style="stroke:#181818;stroke-width:1;" x1="265.4897" x2="306.4897" y1="604.4219" y2="604.4219"/><polygon fill="#181818" points="275.4897,600.4219,265.4897,604.4219,275.4897,608.4219,271.4897,604.4219" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="271.4897" y="586.356">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="206.8511" x="293.5806" y="586.356">Evaluate trust with the client_id</text></g><path d="M188.3389,619.4219 L252.7817,619.4219 L252.7817,626.5547 L242.7817,636.5547 L188.3389,636.5547 L188.3389,619.4219 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="#FFFFFF" fill-opacity="0.00000" height="132.3359" style="stroke:#000000;stroke-width:1.5;" width="1133.1226" x="188.3389" y="619.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="203.3389" y="632.4888">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="250.5293" x="267.7817" y="631.6323">[if request_uri_method is set with POST]</text><g><polygon fill="#181818" points="987.8628,653.6875,997.8628,657.6875,987.8628,661.6875,991.8628,657.6875" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="264.4897" x2="993.8628" y1="657.6875" y2="657.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="271.4897" y="652.6216">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="343.0591" x="293.5806" y="652.6216">Provide Wallet metadata to the request_uri endpoint</text></g><g><line style="stroke:#181818;stroke-width:1;" x1="1009.8628" x2="1051.8628" y1="686.8203" y2="686.8203"/><line style="stroke:#181818;stroke-width:1;" x1="1051.8628" x2="1051.8628" y1="686.8203" y2="699.8203"/><line style="stroke:#181818;stroke-width:1;" x1="1010.8628" x2="1051.8628" y1="699.8203" y2="699.8203"/><polygon fill="#181818" points="1020.8628,695.8203,1010.8628,699.8203,1020.8628,703.8203,1016.8628,699.8203" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="1016.8628" y="681.7544">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="260.5078" x="1038.9536" y="681.7544">Evaluate the Wallet tecnical capabilities</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="188.3389" x2="1321.4614" y1="708.8203" y2="708.8203"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="334.7104" x="193.3389" y="719.0308">[if request_uri_method is set with GET or not present]</text><g><polygon fill="#181818" points="987.8628,739.7578,997.8628,743.7578,987.8628,747.7578,991.8628,743.7578" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="264.4897" x2="993.8628" y1="743.7578" y2="743.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="271.4897" y="738.6919">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="423.5854" x="293.5806" y="738.6919">Request the signed request object from the request_uri endpoint</text></g><g><polygon fill="#181818" points="275.4897,775.8906,265.4897,779.8906,275.4897,783.8906,271.4897,779.8906" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="269.4897" x2="1003.8628" y1="779.8906" y2="779.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="281.4897" y="774.8247">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141.1528" x="303.5806" y="774.8247">signed request object</text></g><g><line style="stroke:#181818;stroke-width:1;" x1="264.4897" x2="306.4897" y1="809.0234" y2="809.0234"/><line style="stroke:#181818;stroke-width:1;" x1="306.4897" x2="306.4897" y1="809.0234" y2="822.0234"/><line style="stroke:#181818;stroke-width:1;" x1="265.4897" x2="306.4897" y1="822.0234" y2="822.0234"/><polygon fill="#181818" points="275.4897,818.0234,265.4897,822.0234,275.4897,826.0234,271.4897,822.0234" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="271.4897" y="803.9575">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="294.8042" x="293.5806" y="803.9575">Evaluate Relying Party Metadata and policies</text></g><g><line style="stroke:#181818;stroke-width:1;" x1="264.4897" x2="306.4897" y1="851.1563" y2="851.1563"/><line style="stroke:#181818;stroke-width:1;" x1="306.4897" x2="306.4897" y1="851.1563" y2="864.1563"/><line style="stroke:#181818;stroke-width:1;" x1="265.4897" x2="306.4897" y1="864.1563" y2="864.1563"/><polygon fill="#181818" points="275.4897,860.1563,265.4897,864.1563,275.4897,868.1563,271.4897,864.1563" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="271.4897" y="846.0903">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="297.1528" x="293.5806" y="846.0903">Verify signature of the signed Request Object</text></g><g><line style="stroke:#181818;stroke-width:1;" x1="264.4897" x2="306.4897" y1="893.2891" y2="893.2891"/><line style="stroke:#181818;stroke-width:1;" x1="306.4897" x2="306.4897" y1="893.2891" y2="906.2891"/><line style="stroke:#181818;stroke-width:1;" x1="265.4897" x2="306.4897" y1="906.2891" y2="906.2891"/><polygon fill="#181818" points="275.4897,902.2891,265.4897,906.2891,275.4897,910.2891,271.4897,906.2891" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="271.4897" y="888.2231">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161.2622" x="293.5806" y="888.2231">Validate requested VP(s)</text></g><g><polygon fill="#181818" points="39.9551,931.4219,29.9551,935.4219,39.9551,939.4219,35.9551,935.4219" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="33.9551" x2="253.4897" y1="935.4219" y2="935.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="45.9551" y="930.356">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.9775" x="68.0459" y="930.356">Request for consent</text></g><g><polygon fill="#181818" points="242.4897,960.5547,252.4897,964.5547,242.4897,968.5547,246.4897,964.5547" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="23.9551" x2="248.4897" y1="964.5547" y2="964.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="30.9551" y="959.4888">19</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="67.7168" x="53.0459" y="959.4888">Confirmed</text></g><g><polygon fill="#181818" points="987.8628,1004.8203,997.8628,1008.8203,987.8628,1012.8203,991.8628,1008.8203" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="264.4897" x2="993.8628" y1="1008.8203" y2="1008.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="271.4897" y="996.188">20</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="192.6196" x="293.5806" y="988.6216">POST Authorization Response</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="302.396" x="297.7129" y="1003.7544">with vp_token, state, presentation_submission</text></g><g><line style="stroke:#181818;stroke-width:1;" x1="1009.8628" x2="1051.8628" y1="1037.9531" y2="1037.9531"/><line style="stroke:#181818;stroke-width:1;" x1="1051.8628" x2="1051.8628" y1="1037.9531" y2="1050.9531"/><line style="stroke:#181818;stroke-width:1;" x1="1010.8628" x2="1051.8628" y1="1050.9531" y2="1050.9531"/><polygon fill="#181818" points="1020.8628,1046.9531,1010.8628,1050.9531,1020.8628,1054.9531,1016.8628,1050.9531" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="1016.8628" y="1032.8872">21</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="275.4883" x="1038.9536" y="1032.8872">Evaluate the Verifiable Presentation token</text></g><g><line style="stroke:#181818;stroke-width:1;" x1="1009.8628" x2="1051.8628" y1="1125.4844" y2="1125.4844"/><line style="stroke:#181818;stroke-width:1;" x1="1051.8628" x2="1051.8628" y1="1125.4844" y2="1138.4844"/><line style="stroke:#181818;stroke-width:1;" x1="1010.8628" x2="1051.8628" y1="1138.4844" y2="1138.4844"/><polygon fill="#181818" points="1020.8628,1134.4844,1010.8628,1138.4844,1020.8628,1142.4844,1016.8628,1138.4844" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="1016.8628" y="1097.7192">22</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="204.2231" x="1038.9536" y="1075.02">Validate the Wallet Attestation.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167.8638" x="1038.9536" y="1090.1528">Attest the Wallet Provider</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157.3774" x="1043.0859" y="1105.2856">is part of the Federation</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="255.5947" x="1043.0859" y="1120.4185">and the Wallet Instance is not revoked.</text></g><g><line style="stroke:#181818;stroke-width:1;" x1="1009.8628" x2="1051.8628" y1="1182.75" y2="1182.75"/><line style="stroke:#181818;stroke-width:1;" x1="1051.8628" x2="1051.8628" y1="1182.75" y2="1195.75"/><line style="stroke:#181818;stroke-width:1;" x1="1010.8628" x2="1051.8628" y1="1195.75" y2="1195.75"/><polygon fill="#181818" points="1020.8628,1191.75,1010.8628,1195.75,1020.8628,1199.75,1016.8628,1195.75" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="1016.8628" y="1170.1177">23</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190.9058" x="1038.9536" y="1162.5513">Attest Credential Issuer Trust</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177.8804" x="1043.0859" y="1177.6841">and Validate JWT Signature</text></g><g><line style="stroke:#181818;stroke-width:1;" x1="1009.8628" x2="1051.8628" y1="1224.8828" y2="1224.8828"/><line style="stroke:#181818;stroke-width:1;" x1="1051.8628" x2="1051.8628" y1="1224.8828" y2="1237.8828"/><line style="stroke:#181818;stroke-width:1;" x1="1010.8628" x2="1051.8628" y1="1237.8828" y2="1237.8828"/><polygon fill="#181818" points="1020.8628,1233.8828,1010.8628,1237.8828,1020.8628,1241.8828,1016.8628,1237.8828" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="1016.8628" y="1219.8169">24</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144.6948" x="1038.9536" y="1219.8169">Process the credential</text></g><rect fill="#90EE90" height="83" style="stroke:#181818;stroke-width:0.5;" width="537" x="735" y="1250.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149.0747" x="739" y="1266.9497">Process the credential:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="374.6069" x="743.1323" y="1282.0825">- Check Holder Key Binding and Proof of Possession using</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="399.4263" x="751.397" y="1297.2153">the public key bound in the Credential to verify the VP token.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="739" y="1312.3481">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="525.8271" x="743.1323" y="1327.481">- Extract the disclosed attributes and check if all the required data are available.</text><g><line style="stroke:#181818;stroke-width:1;" x1="1009.8628" x2="1051.8628" y1="1360.6797" y2="1360.6797"/><line style="stroke:#181818;stroke-width:1;" x1="1051.8628" x2="1051.8628" y1="1360.6797" y2="1373.6797"/><line style="stroke:#181818;stroke-width:1;" x1="1010.8628" x2="1051.8628" y1="1373.6797" y2="1373.6797"/><polygon fill="#181818" points="1020.8628,1369.6797,1010.8628,1373.6797,1020.8628,1377.6797,1016.8628,1373.6797" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="1016.8628" y="1355.6138">25</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="273.2222" x="1038.9536" y="1355.6138">Update the User session (cookie updated)</text></g><g><polygon fill="#181818" points="270.4897,1398.8125,260.4897,1402.8125,270.4897,1406.8125,266.4897,1402.8125" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="264.4897" x2="1003.8628" y1="1402.8125" y2="1402.8125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="276.4897" y="1397.7466">26</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110.3857" x="298.5806" y="1397.7466">HTTP/1.1 200 OK</text></g><g><polygon fill="#181818" points="1319.4419,1443.0781,1329.4419,1447.0781,1319.4419,1451.0781,1323.4419,1447.0781" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="617.7334" x2="1325.4419" y1="1447.0781" y2="1447.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="624.7334" y="1434.4458">27</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="247.438" x="646.8242" y="1426.8794">JavaScript check: authentication state</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="175.5127" x="650.9565" y="1442.0122">(HTTP request with cookie)</text></g><g><polygon fill="#181818" points="623.7334,1487.3438,613.7334,1491.3438,623.7334,1495.3438,619.7334,1491.3438" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="617.7334" x2="1335.4419" y1="1491.3438" y2="1491.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="629.7334" y="1478.7114">28</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110.3857" x="651.8242" y="1471.145">HTTP/1.1 200 OK</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="299.3174" x="655.9565" y="1486.2778">{"redirect_uri": https url with response_code}</text></g><g><line style="stroke:#181818;stroke-width:1;" x1="612.7334" x2="654.7334" y1="1520.4766" y2="1520.4766"/><line style="stroke:#181818;stroke-width:1;" x1="654.7334" x2="654.7334" y1="1520.4766" y2="1533.4766"/><line style="stroke:#181818;stroke-width:1;" x1="613.7334" x2="654.7334" y1="1533.4766" y2="1533.4766"/><polygon fill="#181818" points="623.7334,1529.4766,613.7334,1533.4766,623.7334,1537.4766,619.7334,1533.4766" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="619.7334" y="1515.4106">29</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="225.3354" x="641.8242" y="1515.4106">Redirect to the protected resource</text></g><!--SRC=[XLPHRzis47xdhpYu3qk096lt6203qZHBqdQBcxZDGpCOj4JRN6HI8ocvth3_tkz8IQQT50ly48cyk- - - - -vEiWdMDAkPSaA8yo9OHwFFNhaHIK-D43FxBRtuoTCxrUf2-H6z-gWNo_2sQfIefGkwqBKqWKOFigfKe1lZWpI5YZxMkrSQk3gM2sL2YY25CYKXIXVgJbKRRHOqXj7cnv5shZsQWzlp9Ypfej9mV1WzjtiMW1GQJuXMMzr5zseRNGXP1DtAe91sGyU_0jifFQWPtIl7UPEHhLx8eAt9hafHgjnGicMhJkbE_Tqe7sZiR515K2NUUDkuGWbnTeRNoWDhT4VZfVIApiwsVe6-LRsh2wVudIJE0MSIT3oQcMs0FLZQKag5jK_w1LENm4mRf_5_1sDx2mMhWJ7t53OrOi1xgHW-5SvwZuV814JYvKfrZvqZfciPLXNLy41hZNfykhkmPRo-T6eET4XO6xsWi0HPhegt7aqHopRLvL4Ez2YbUqHVivVJbGfBM_wPimwkH4TySqhtIxkE_hlW4GqG84Zn50yYbbaJ8FoTuiaj_MiX5iusDVZZjDzrQPjg8zOSPuquXJI8GHo4LIHODEdejbOcHjhh1v9r_MWgMyWgKaqIeaNckaYg6dnVSeaPHt0D91IvP7y3KH1h5KZFwJarf5dNdT7uzduY27_hljIGOwlB0HfiP2c3P1rnX5meVQj41pdR_BmLpnRiDcD8ncXEiv2rdEbA1wsyK1LK_l-WhoudN31Z0zMfIqIUGTzO7CxhXK5dTGx9plvYhSwTNVqucrWhXf-uVj75CtazgypE0ABVUnebMhAsa1hdsnjzKKxFDp4IPf23aEOv-ZwXsnHwi9ALBhFcnSqlumD_c2uqMoBch6vh8b6xComvkh1chjrAbRkZQYi9Y8HuVbgd_qa32QEgPe_qQ59DsdeQx9CoGrFMsVoQ-cQsqjxlJCQT2RQZaKY7bhDAxKx1620p6WZ8X7KUWlBf_Wd0fSVyGgTl1-3G56-0dktV55v7IvnndLxgKDYmxfng0QOyoT1qeJ1GIsvPQFl6-mPDFE4UxLmEaDy_JEY-htVc1V2mGNtgvi6L40vHeOiM_d3vrSURg-l9rTtbvH_YPOjJGSTqiLGOQTUsGcBqGMtehJObYvAXm0w9upV615EnE1WwV4hSJkokRcPGAZt1CYqJdSPMbYF6GflK6oitJaKw4Hp-ybjmA7SyARKlAkkXKHc2qvYkoaSOHSI8fWVHGqzg1A3KB-W6sKfTiHnEk3SZ4oAZx7CzY82_GwXFvY0jEshYUNaeygw-dap6FxyvUKE_l7vDjn_s-pbxNFUxmoCMlGUO-yBfEYJaftipkbl1AFS1XnZ6HcoI1EXGlBXIyAtX4pnUb7luuE_V4KW1CKKSLoFUfQ7smvRajHrRSbfWuVotjxYo9vzjGyb38Zdj1tmzV8xqtm7V0G00]--></g></svg>